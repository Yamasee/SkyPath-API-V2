
WeatherEvent:
  type: object
  properties: 
    tileX:
      description: tileX of the event
      type: integer
    tileY:
      description: tileY of the event
      type: integer
    alt:
      description: alt of the event
      type: integer
    ts: 
      description: unix epoch time stamp of update
      type: integer
    type:
      description: event type , 'cb' , 'icing','shear','lightning'
      type: string
    fNum:
      description: Flight number
      type: string
  example:
    alt: 12
    tileX: 1023
    tileY: 304
    ts: 1577349257
    type: 'cb'
    fNum: 'LY001'

Position:
  type: object
  properties: 
    uuid:
      description: unique ID for this plane generated by the server can be used to identify specific plane and diff between updates
      type: string
    alt:
      description: altitude of plane in tiles 
      type: integer
    tile_x:
      description: position in x axis tiles
      type: integer
    tile_y:
      description: position in y axis tiles
      type: integer
    speed:
      description: speed in knots 
      type: integer
    ts: 
      description: unix epoch time stamp of update
      type: integer
    hdg:
      description: plane heading
      type: integer
    lat: 
      description: position latitude 
      type: number
    lon:
      description: position longitude  
      type: number
  example:
    uuid: "46087afaeb79d682820fe604bc8a075c"
    alt: 12
    tile_x: 1023
    tile_y: 304
    speed: 12
    ts: 1577349257
    hdg: 209
    lat: 44.55719190061772
    lon: 16.962290836610837

PositionsArray:
  type: array
  items:
    $ref: "#/Position"

PositionsResponse:
  type: object 
  properties:
    positions:
      $ref: "#/PositionsArray"

TurbulenceReport:
  type: object
  properties: 
    alt:
      description: alt in tiles 
      type: number
    tileX:
      description: tileX of report
      type: number
    tileY:
      description: tileY of report
      type: number
    sev:
      description: severity level
      type: number
    tick:
      description: skypath system virtual tick at time of report
      type: number
    ts:
      description: unix epoch
      type: number

TurbulenceArray:
  type: array
  items:
    $ref: "#/TurbulenceReport"

Metadata: 
  type: object
  properties:
    tag:
      description: Tag with file details
      type: object
    uuid:
      description: Unique id for raw data file
      type: string
    user_id:
      description: Creator user
      type: string
    url:
      description: Url to download raw data file
      type: string

StaticContentListResponse:
  type: array
  items:
    type: object
    properties: 
      uid:
        type: string
      sha1:
        type: string
      version:
        type: number
      uploaded: 
        type: number
  example:
    - uid : "airports_list"
      sha1 : "ee03bb8fcc77500004154d3c75a8f17db126e549"
      version : 1
      uploaded: 1600802938479
    - uid : "fir_borders_list"
      sha1 : "aa99bb8fcc77500004154d3c75a8f17db126e543"
      version : 2
      uploaded: 1600802936002

AircraftTypesResponse:
  type: array
  items:
    type: object
    properties: 
      id:
        type: string
      title:
        type: string
      size:
        type: string
        enum: ['small', 'medium', 'large']
  example:
    - id : "737"
      title : Boeing 737
      size: 'large'
    - id : "747"
      title : Boeing 747
      size: 'large'
    - id : "A320"
      title : AirBus 320
      size: 'medium'

UserStatusResponse:
  type: object
  required:
    - initialized
  properties:
    fresh:
      description: Is this user initialized ?
      example: false
      type: boolean

SettingsResponse:
  type: object
  properties:
    modules:
      type: object 
  example:   
    modules:
      module_a: 
        property_a: x1 
        size: 8
      module_b: 
        property_a: 2
        ability: 67

RefreshTokenResponse:
  type: object
  required:
    - new_token
  properties:
    new_token:
      description: new JWT token with new expiry of 3 hours
      example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6ImUwMTAxMDEiLCJyb2xlIjoiYWRtaW4iLCJjb21wYW55IjoiWWFtYXNlZSIsImNvbXBhbnlJbnRlcm5hbElkIjoiWVMiLCJpYXQiOjE1NzM1NzM3MDQsImV4cCI6MTYwNTEwOTcwNH0.R9S2BOVpRx6H9_0lZWKqRg93kgYweR3kN3OZonHQY4w'
      type: string
    new_refresh_token: 
      description: optional new refresh token in case server replaces refresh token
      example: 'Jyb2xlIjoiYWRtaW4iLCJjb21wYW55IjoiWWFtYXNlZSIsImNvbXBhbnlJ93kgYweR3kN3OZonHQY4w'
      type: string

DeliveryKeyResponse:
  type: object
  required:
    - delivery_token
    - expires
  properties:
    delivery_token:
      description: use this token in the /updates /initial routes
      example: 'Jyb2xlIjoiYWRtaW4iLCJjb21wYW55IjoiWWFtYXNlZSIsImNvbXBhbnlJ93kgYweR3kN3OZonHQY4w'
      type: string
    expires: 
      description: when the token expires
      example: 15566666606
      type: integer

HelloResponse:
  type: object
  required:
    - ver
    - current_app_version
    - minimal_compatible_app_version
  properties:
    ver:
      description: current server version
      example: '1.2.4'
      type: string
    current_app_version: 
      description: current app client version
      example: '4.0.0'
      type: string
    minimal_compatible_app_version:
      description: current minimal supported app or client version
      example: '3.5.1'
      type: string

LoginSSOResponse:
  type: object
  properties:
    sso_url:
      type: string
      example: https://domain.com/sso?token=abcd
    timeouts:
      type: object
      properties:
        session:
          type: number
          example: 120
        idle:
          type: number
          example: 600

LoginOTPResponse:
  type: object
  properties:
    otp_token:
      type: string
      example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJ5b3NzaWZyYW5jZXMiLCJpYXQiOjE1OTg1MTUyMzUsImV4cCI6MTU5ODUxNTgzNX0.nbe4uPeFHwSWiv0_TWCtyRErxTk_KvmhTVp14vBLZVA'

OTPRequestResponse:
  type: object
  properties:
    otp_sent:
      type: boolean
      example: true

OTPValidationResponse:
  type: object
  properties:
    set_profile_token:
      type: string
      example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJ5b3NzaWZyYW5jZXMiLCJpYXQiOjE1OTg1MTUyMzUsImV4cCI6MTU5ODUxNTgzNX0.nbe4uPeFHwSWiv0_TWCtyRErxTk_KvmhTVp14vBLZVA'

LoginResponse:
  type: object
  properties:
    token:
      type: string
      example: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6ImUwMTAxMDEiLCJyb2xlIjoiYWRtaW4iLCJjb21wYW55IjoiWWFtYXNlZSIsImNvbXBhbnlJbnRlcm5hbElkIjoiWVMiLCJpYXQiOjE1NzM1NzM3MDQsImV4cCI6MTYwNTEwOTcwNH0.R9S2BOVpRx6H9_0lZWKqRg93kgYweR3kN3OZonHQY4w'
    refresh_token:
      type: string
      example : 'R9S2BOVpRx6H9_0lZWKqRg93kgYweR3kN3OZonHQY4w'
    user_id: 
      type: string
      example : 'ym0565666'
    role:
      type: string
      example: 'pilot'
    company:
      type: string
      example : 'united airlines'
    company_id:
      type: string
      example: 'UA'
    first_name:
      type: string
      example : 'John'
    last_name:
      type: string
      example : 'Baker'
    email:
      type: string
      example: 'john.baker@skypathapi.com'

InitialResponse:
  type: object
  properties:
    skypath_tick:
      description: describes the current system virtual clock tick, used for partial updates 
      type: integer
    hours:
      description: how many hours back data included
      type: integer
    updates: 
      type: object
      properties:
        positions:
          type: array
          items:
            $ref: "#/Position"
        turbulences:
          type: array
          items:
            $ref: "#/TurbulenceReport"
        weather_events:
          type: array
          items:
            $ref: "#/WeatherEvent"
  example:
    skypath_tick: 4567
    updates:
      turbulences: 
        -
          alt: 34
          tileX: 1020
          tileY: 681
          sev: 2
          ts: 1574057162
        -
          alt: 35
          tileX: 1019
          tileY: 680
          sev: 1
          ts: 1574057163
      positions: 
        -
          uuid: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9'
          alt: 24695.00122597656
          hdg: 235.8984375
          lat: 59.61784533711745
          lng: -38.32425758432409
          speed: 269.04998779296875
          ts: 1574057471
      weather_events: 
        -
          alt: 34
          tileX: 1020
          tileY: 681
          type: 'cb'
          ts: 1574057162
        -
          alt: 35
          tileX: 1019
          tileY: 680
          type: 'shear'
          ts: 1574057163

UpdateResponse:
  type: object
  properties:
    skypath_tick:
      type: integer
    updates: 
      type: object
      properties:
        positions:
          type: array
          items:
            $ref: "#/Position"
        turbulences:
          type: array
          items:
            $ref: "#/TurbulenceReport"
        weather_events:
          type: array
          items:
            $ref: "#/WeatherEvent"

  example:
    skypath_tick: 4567
    updates:
      turbulences: 
        -
          alt: 34
          tileX: 1020
          tileY: 681
          sev: 2
          tick: 76
          ts: 1574057162
        -
          alt: 35
          tileX: 1019
          tileY: 680
          sev: 1
          tick: 76
          ts: 1574057163
      positions: 
        -
          airplane: '737'
          alt: 24695.00122597656
          hdg: 235.8984375
          lat: 59.61784533711745
          lng: -38.32425758432409
          speed: 269.04998779296875
          ts: 1574057471
          uuid: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9'
      weather_events: 
        -
          alt: 34
          tileX: 1020
          tileY: 681
          type: 'cb'
          tick: 78
          ts: 1574057162
        -
          alt: 35
          tileX: 1019
          tileY: 680
          tick: 78
          type: 'shear'
          ts: 1574057163


